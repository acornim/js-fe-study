# 주제

## 발표자

- 김김김

## 참여자

- 김김김, 김김김, 김김김, ...

## 내용
### 1. Scope

> 스코프는 흔히, 변수의 생존 범위 라고 알고 있다. 나 또한 그렇게만 생각하고 있었다. 물론 이 말이 마냥 틀린것은 아니지만,  스코프는 보다 넓은 개념을 포함하는 단어이다. 
>
> 그래서 스코프를 알기 전에, 자바스크립트 프로그램이 어떻게 작동하는지를 먼저 볼것이다.

#### 자바스크립트 프로그램은 어떻게 실행될까?

* 자바스크립트 프로그램은 **Engine, Compiler, Scope**에 의해 실행된다. (보다 정확하게는 엔진에 의해 실행되지만, 컴파일러와 스코프는 엔진의 명령에 따라 각기 맡은 일을 하기 때문에, 각각에 의해 실행된다는 것도 마냥 틀리지만은 않다고 생각한다)

#### Engine

* Compilation의 전 과정과 자바스크립트 프로그램 실행의 전 과정을 담당한다.
* 우리가 흔히 아는 V8은 자바스크립트의 다양한 엔진 중 하나이다.

#### Compiler (Do compilation)

* 컴파일레이션을 한다. 컴파일레이션이란 엔진이 실행할 수 있는 코드를 생성하는 과정을 말한다. 
* 컴파일레이션은 `토크나이징/렉싱`, `파싱`, `코드 생성` 의 총 3단계로 이루어져있다.



##### 예시와 함께 보자.

* 아래와 같은 자바스크립트 프로그램이 있다. 

<img src="./image/1_default.png" style="zoom:50%;" />

##### 토크나이징/렉싱 (Tokenizing/Lexing)

* 문자열을 나누어, token이라 하는 의미 있는 조각으로 나누는 것을 말한다.

* 이 과정을 거치면, 그림처럼 `const`, `a`, `=`, `5`, `=` 으로 나뉘어진다.

<img src="./image/1_lexing.png" style="zoom:50%;" />

##### 파싱 (Parsing)

* 토큰 배열을 프로그램의 문법 구조를 반영하여 트리 구조로 만드는 것을 말한다. 이 과정을 거쳐 만들어진 것을 AST(Abstract Syntax Tree) 라 한다. 

* 이 과정을 거치면, 그림과 같은 (똑같지는 않다) AST가 생성된다.

<img src="./image/1_ast.png" style="zoom:50%;" />

##### 코드 생성 (Code-Generation)

* 엔진이 실행할 수 있는 코드를 생성한다.



이해를 돕기 위해 작성한 거라서 실제와 조금 다르다. 보다 정확하고 자세하게 알고싶다면 [이 사이트](https://gyujincho.github.io/2018-06-19/AST-for-JS-devlopers)를 방문해보자.



#### Scope

* 스코프는 **변수의 생존범위** 를 말한다, 라고 하면 틀린 말은 아니다. 하지만 뭔가 아쉬움이 있다. 왜냐하면 스코프는 이보다 큰 개념을 포함하는 단어이기 때문이다.

##### 스코프와 변수

* 코드를 작성하는동안 다양하고 많은 변수들이 선언되고 할당되고 사용된다. 그렇다면 프로그램은 어떤 변수가 어디에 저장되어있는지 **어떻게 찾는걸까**? **어떤 규칙이 필요하지 않을까**? 
* 이러한 일을 하는 것이 스코프이다. 즉 스코프는 생존 범위 만을 말하는 것이 아니라, **규칙에 따라 변수에 관한 목록을 작성하고 관리**하는 것을 말한다. 따라서  `스코프는 변수의 생존범위를 말한다`  라는 정의는 조금 아쉬움이 남는 것이다.



#### 컴파일러와 엔진과 스코프가 어떻게 자바스크립트 프로그램을 실행하는지를 알아보자

* 아래의 코드가 어떤 과정을 거쳐서 5라는 결과를 보여주는지를 알아볼 것이다.

```javascript
var a = 5; 
console.log(a); // 5
```



* 이것은 엔진이 실행하는 코드이다. (완전 똑같지는 않지만, 의미적으로 비슷하다) 위의 코드가 아래의 코드로 변환되고, 이를 엔진이 실행한다.

```javascript
var a;
a = 5;

console.log(a);
```



이걸 조금 더 자세히보면,

`var a;` 이건 컴파일러가 실행하는 코드로, 컴파일러가 스코프에게 변수 a가 특정한 스코프 컬렉션(a.k.a 범위) 안에 있는지를 물어보는 것이다. 이미 컬렉션 안에 있다면 무시하고 지나가고, 없다면 **컴파일러가 스코프에게** 스코프 컬렉션에 추가하라고 요청한다.

`a = 5;` 이건 엔진이 실행하는 코드로, 엔진은 이 코드를 처리하는 동안 두 가지의 일을 한다.

1. `a` 는 현재 스코프 컬렉션 내에서 접근할 수 있는가?
2. 그렇다면 `a` 에게 `5` 를 할당한다. (그렇지 않다면 다른 중첩 스코프를 본다)

이렇게 a에게 5가 할당이 되었다. 그리고 `console.log(a);` 를 실행하여 5를 출력하게 되었다.



즉 값을 할당하고, 값을 불러오는 두 가지의 일을 한 것이다. 이것을 좀 더 자세히 보자.



##### 할당하고, 불러오기

앞선 소스로 한 일을 크게 나누어서 생각해보면, **엔진**은 **할당하는 것** `a = 5;` 과 값을 **불러와서** 출력하는 것 `console.log(a);` 두 개의 일을 했다. 

* 값을 할당한다. **LHS**
* 값을 할당할 때 엔진이 하는 검색은, LHS(Left-Hand Side) 검색이다. LHS 검색은, 왼쪽에 있을 때에 수행하는 것이다. 무엇이? 변수가!
* 즉 변수를 할당할 때 일어나는 검색이 LHS 검색이다.
* 값을 찾는다. **RHS**
* 값을 찾으려 할 때 엔진이 하는 검색은, RHS(Right-Hand Side) 검색이다. RHS 검색은 위와 반대로 변수가 오른쪽에 있을 때 수행하는 것이다. 



이 내용을 공부하면서 굉장히 좋은 자료를 찾았다. [이 블로그](https://yuddomack.tistory.com/entry/자바스크립트-스코프scope?category=798820)다.





